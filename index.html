<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quadra - Meditative Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="background-container">
        <div id="stars"></div>
        
        <div id="forest-theme" class="theme-container">
            <div class="forest-moon"></div>
            <div id="enchanted-forest-back" class="enchanted-forest-layer"></div>
        <div class="forest-mist" id="forest-mist-back"></div>
            <div id="enchanted-forest-mid" class="enchanted-forest-layer"></div>
        <div class="forest-mist" id="forest-mist-front"></div>
            <div id="fireflies"></div>
        <div id="forest-particles"></div>
            <div id="enchanted-forest-front" class="enchanted-forest-layer"></div>
        </div>
        <div id="ocean-theme" class="theme-container">
            <div class="caustics-container"></div>
            <div class="ocean-water-bg"></div>
            <div id="ocean-plankton-layer"></div>
            <div id="ocean-floor-bg" class="ocean-parallax"></div>
            <div class="ocean-god-rays"></div>
            <div id="ocean-floor-mid" class="ocean-parallax"></div>
            <div id="bubbles"></div>
            <div id="jellyfish-layer"></div>
            <div id="ocean-floor-fg" class="ocean-parallax"></div>
        </div>
        <div id="sunset-theme" class="theme-container">
            <div class="sun-and-sky">
                <div class="sun"></div>
                <div class="lens-flare"></div>
                <div class="sunset-god-rays"></div>
            </div>
            <div id="sunset-clouds-back" class="sunset-clouds"></div>
            <div id="sunset-clouds-mid" class="sunset-clouds"></div>
            <div id="dust-motes"></div>
            <div class="mountain-silhouette"></div>
            <div id="sunset-clouds-front" class="sunset-clouds"></div>
            <div class="sunset-heat-haze"></div>
        </div>
        <div id="mountain-theme" class="theme-container">
            <div class="mountain-sky"></div>
            <div id="mountain-stars"></div>
            <div id="mountain-range-back" class="mountain-range"></div>
            <div class="mountain-clouds"></div>
            <div id="mountain-range-mid" class="mountain-range"></div>
            <div class="mountain-fog"></div>
            <div id="mountain-range-front" class="mountain-range"></div>
        </div>
        <div id="zen-theme" class="theme-container">
            <div class="raked-sand"></div>
            <div class="water-feature">
                <div class="zen-ripple"></div>
            </div>
            <div id="petals"></div>
        </div>
        <div id="winter-theme" class="theme-container">
            <div class="wind-overlay"></div>
            <div id="snowflakes-back" class="snowflakes-layer"></div>
            <div id="snowflakes-mid" class="snowflakes-layer"></div>
            <div id="snowflakes-front" class="snowflakes-layer"></div>
            <div class="window-pane">
                <div class="frost-overlay"></div>
                <div class="ice-crystals"></div>
            </div>
        </div>
        <div id="fall-theme" class="theme-container">
            <div class="fall-bg"></div>
            <div id="fall-wind-particles"></div>
            <div id="fall-leaves-back" class="fall-leaves-layer"></div>
            <div id="fall-leaves-mid" class="fall-leaves-layer"></div>
            <div id="fall-leaves-front" class="fall-leaves-layer"></div>
            <div class="ground-leaves"></div>
        </div>
        <div id="summer-theme" class="theme-container">
            <div class="summer-sky"></div>
            <div class="god-rays-summer"></div>
            <div id="dandelion-seeds"></div>
            <div class="heat-haze"></div>
            <div class="summer-grass"></div>
        </div>
        <div id="spring-theme" class="theme-container">
            <div id="spring-clouds"></div>
            <div id="rainbow-container"></div>
            <div id="spring-rain">
                <div id="rain-back" class="rain-layer"></div>
                <div id="rain-mid" class="rain-layer"></div>
                <div id="rain-front" class="rain-layer"></div>
            </div>
            <div class="spring-ground"></div>
            <div id="sprouts-container"></div>
        </div>
        <div id="aurora-theme" class="theme-container">
            <div id="aurora-stars"></div>
            <div class="aurora-curtain" id="aurora-layer-1"></div>
            <div class="aurora-curtain" id="aurora-layer-2"></div>
            <div class="aurora-curtain" id="aurora-layer-3"></div>
        </div>
        <div id="galaxy-theme" class="theme-container">
            <div id="galaxy-stars-bg"></div>
            <div class="nebula-container">
                <div class="nebula" id="nebula-layer-1"></div>
                <div class="nebula" id="nebula-layer-2"></div>
                <div class="nebula" id="nebula-layer-3"></div>
            </div>
            <div id="shooting-stars"></div>
        </div>
        <div id="rainy-window-theme" class="theme-container">
            <div class="rainy-bg"></div>
            <canvas id="rain-canvas"></canvas>
            <div class="lightning-flash"></div>
        </div>
        <div id="koi-pond-theme" class="theme-container">
            <div class="water-depth-overlay"></div>
            <div class="water-surface"></div>
            <div id="lily-pads"></div>
            <div id="koi-fish"></div>
            <div id="koi-ripples"></div>
        </div>
        <div id="meadow-theme" class="theme-container">
            <div class="meadow-sky"></div>
            <div id="meadow-pollen"></div>
            <div id="meadow-butterflies"></div>
            <div class="meadow-grass"></div>
            <div id="meadow-flowers"></div>
        </div>
        <div id="cosmic-chimes-theme" class="theme-container">
            <div class="chime-nebula"></div>
            <div id="space-dust"></div>
            <div id="chimes"></div>
        </div>
        <div id="singing-bowl-theme" class="theme-container">
            <div id="singing-bowl-glow"></div>
            <div class="singing-bowl-silhouette"></div>
            <div id="bowl-ripples"></div>
            <div id="bowl-motes"></div>
        </div>
        <div id="starlight-theme" class="theme-container">
            <div id="starlight-nebula"></div>
            <div id="starlights-back" class="starlight-layer"></div>
            <div id="starlights-mid" class="starlight-layer"></div>
            <div id="starlights-front" class="starlight-layer"></div>
            <div id="starlight-shooting-stars"></div>
        </div>
        <div id="geode-theme" class="theme-container">
            <div id="geode-dust-back"></div>
            <div id="geode-crystals"></div>
            <div id="geode-dust-mid"></div>
            <div id="geode-dust-front"></div>
        </div>
        <div id="bioluminescence-theme" class="theme-container">
            <div id="bio-mushrooms"></div>
            <div id="bio-spores"></div>
        </div>
        <div id="swedish-forest-theme" class="theme-container">
            <div id="sf-layer-1" class="sf-parallax"></div>
            <div class="god-ray-container"></div>
            <div id="sf-layer-2" class="sf-parallax"></div>
            <div class="mist"></div>
            <div id="sf-layer-3" class="sf-parallax"></div>
            <div id="forest-spirits"></div>
        </div>
    </div>

    <div class="game-container">
        <div class="sidebar">
            <div class="panel">
                <h2>STATS</h2>
                <div class="stat-row"><span class="stat-label">SCORE</span><span id="score" class="stat-value">0</span></div>
                <div class="stat-row"><span class="stat-label">LINES</span><span id="lines" class="stat-value">0</span></div>
                <div class="stat-row"><span class="stat-label">LEVEL</span><span id="level" class="stat-value">1</span></div>
                <div class="stat-row"><span class="stat-label">NEXT LVL</span><span id="next-level" class="stat-value">10</span></div>
                <div class="stat-row"><span class="stat-label">SPEED</span><span id="speed" class="stat-value">1.0x</span></div>
                <div class="stat-row"><span class="stat-label">BPM</span><span id="bpm" class="stat-value">0</span></div>
            </div>
            <div class="panel">
                <h2>CONTROLS</h2>
                <div class="controls-info"><div id="controls-list"></div></div>
            </div>
            <button id="sound-toggle" class="action-btn">üîä</button>
            <button id="next-track-btn" class="action-btn">üéµ</button>
            <button id="fullscreen-toggle" class="action-btn">‚õ∂</button>
            <button id="settings-btn" class="action-btn">‚öôÔ∏è</button>
        </div>
        <div class="game-area">
            <div class="next-pieces-container">
                <div class="next-piece-box main"><span class="next-piece-label">Next</span><canvas id="next-0" width="60" height="50"></canvas></div>
                <div class="next-piece-box"><canvas id="next-1" width="50" height="40"></canvas></div>
                <div class="next-piece-box"><canvas id="next-2" width="50" height="40"></canvas></div>
                <div class="next-piece-box"><canvas id="next-3" width="50" height="40"></canvas></div>
                <div class="next-piece-box"><canvas id="next-4" width="50" height="40"></canvas></div>
            </div>
            <div style="position: relative;">
                <canvas id="game-canvas"></canvas>
                <div id="score-popups"></div>
            </div>
        </div>
    </div>

    <div id="start-modal" class="modal visible">
        <div class="modal-content">
            <h1>QUADRA</h1>
            <p>Press any key or tap to start</p>
        </div>
    </div>
    <div id="game-over-modal" class="modal">
        <div class="modal-content">
            <h1>The cycle ends.</h1>
            <div id="final-stats"></div>
            <p>Press any key or tap to restart</p>
        </div>
    </div>
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <h1>SETTINGS</h1>
            <div class="settings-grid">
                <div class="setting">
                    <label for="das-delay">DAS Delay (ms):</label>
                    <div class="slider-container">
                        <input type="range" id="das-delay" min="50" max="300" step="10"><span id="das-delay-value">150</span>
                    </div>
                </div>
                <div class="setting">
                    <label for="das-interval">DAS Interval (ms):</label>
                    <div class="slider-container">
                        <input type="range" id="das-interval" min="10" max="100" step="5"><span id="das-interval-value">50</span>
                    </div>
                </div>
                <div class="setting">
                    <label for="music-track">Music Track:</label>
                    <select id="music-track" class="setting-select">
                        <option value="Ambient">Ambient (Relax)</option>
                        <option value="Decay">Decay (Meditate)</option>
                        <option value="Zen">Zen (Calm)</option>
                        <option value="Nostalgia">Nostalgia (Focus)</option>
                        <option value="Nebula">Nebula (Modern)</option>
                        <option value="Aurora">Aurora</option>
                        <option value="Galaxy">Galaxy</option>
                        <option value="Rainfall">Rainfall</option>
                        <option value="Koi">Koi</option>
                        <option value="Meadow">Meadow</option>
                        <option value="MiracleTone">Miracle Tone (528Hz)</option>
                        <option value="HealingDrone">Healing Drone (174Hz)</option>
                        <option value="CosmicChimes">Cosmic Chimes (Ethereal)</option>
                        <option value="SingingBowl">Singing Bowl (Deep)</option>
                        <option value="Starlight">Starlight (Gentle)</option>
                        <option value="SwedishForest">Swedish Forest (Deep)</option>
                    </select>
                </div>
                <div class="setting">
                    <label for="sfx-set">Sound Effects:</label>
                    <select id="sfx-set" class="setting-select">
                        <option value="Zen">Zen</option>
                        <option value="Retro">Retro</option>
                    </select>
                </div>
                 <div class="setting">
                    <label for="background-mode">Background:</label>
                    <select id="background-mode" class="setting-select">
                        <option value="Level">Level Transition</option>
                        <option value="Random">Random Transition</option>
                        <option value="Specific">Set Specific</option>
                    </select>
                </div>
                <div class="setting" id="theme-setting">
                    <label for="background-theme">Theme:</label>
                    <select id="background-theme" class="setting-select">
                        <option value="forest">Forest</option>
                        <option value="ocean">Ocean</option>
                        <option value="sunset">Sunset</option>
                        <option value="mountain">Mountain</option>
                        <option value="zen">Zen</option>
                        <option value="winter">Winter</option>
                        <option value="fall">Fall</option>
                        <option value="summer">Summer</option>
                        <option value="spring">Spring</option>
                        <option value="aurora">Aurora</option>
                        <option value="galaxy">Galaxy</option>
                        <option value="rainy-window">Rainy Window</option>
                        <option value="koi-pond">Koi Pond</option>
                        <option value="meadow">Meadow</option>
                        <option value="cosmic-chimes">Cosmic Chimes</option>
                        <option value="singing-bowl">Singing Bowl</option>
                        <option value="starlight">Starlight</option>
                        <option value="swedish-forest">Swedish Forest</option>
                        <option value="geode">Geode</option>
                        <option value="bioluminescence">Bioluminescence</option>
                    </select>
                </div>
                <div class="setting"><label>Move Left:</label> <div id="key-moveLeft" class="key-input" tabindex="0">ArrowLeft</div></div>
                <div class="setting"><label>Move Right:</label> <div id="key-moveRight" class="key-input" tabindex="0">ArrowRight</div></div>
                <div class="setting"><label>Rotate Right:</label> <div id="key-rotateRight" class="key-input" tabindex="0">ArrowUp</div></div>
                <div class="setting"><label>Rotate Left:</label> <div id="key-rotateLeft" class="key-input" tabindex="0">z</div></div>
                <div class="setting"><label>Flip (180¬∞):</label> <div id="key-flip" class="key-input" tabindex="0">a</div></div>
                <div class="setting"><label>Soft Drop:</label> <div id="key-softDrop" class="key-input" tabindex="0">ArrowDown</div></div>
                <div class="setting"><label>Hard Drop:</label> <div id="key-hardDrop" class="key-input" tabindex="0">Space</div></div>
                <div class="setting"><label>Toggle Music:</label> <div id="key-toggleMusic" class="key-input" tabindex="0">M</div></div>
            </div>
            <button id="close-settings" class="action-btn">Close</button>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>

